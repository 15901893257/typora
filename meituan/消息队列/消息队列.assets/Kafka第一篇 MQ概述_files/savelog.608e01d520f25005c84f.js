webpackJsonpLogan([1,3],{107:function(e,t,n){e.exports=n(117)},108:function(e,t,n){"use strict";var o=function(e){if("Invalid Date"==e)throw new Error("Invalid Date");return!0},a=function(e){o(e);var t=e.getFullYear(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,a=e.getDate()<10?"0"+e.getDate():e.getDate();return"".concat(t,"-").concat(n,"-").concat(a)},r=function(e){return o(e),new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()},i=function(e){o(e);var t=r(new Date);return e.getTime()>=t&&e.getTime()<c(new Date,1)},c=function(e,t){return o(e),r(new Date(e.getTime()+864e5*t))},u=function(e,t,n){return e<=n&&e>=t},s=function(e,t){return o(e),c(e,t)/1e3-e.getTime()/1e3+(e.getTime()%1e3>0?1:0)};t.a={ONE_DAY_TIME_SPAN:864e5,checkDate:o,stringify:a,getDawnTime:r,isToday:i,getOffsetDayTime:c,countExpireSeconds:s,dayTimeWithinRange:u}},109:function(e,t,n){(function(t){var o=n(111);e.exports=function(e){e=e||{};var n,a=e.ua,r=e.host;try{var i="undefined"!=typeof window;n=!i&&"[object process]"===Object.prototype.toString.call(t.process)}catch(e){n=!1}return n?(a=a||this.req.headers["user-agent"],r=r||this.req.headers.host):(a=a||window.navigator.userAgent||window.navigator.vendor||window.opera,r=r||window.location.host),o(a,r,n)}}).call(t,n(110))},110:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},111:function(e,t){function n(e,t){var n="";if(/(iPhone\/)?iPhone\s?X/.test(e))n="iPhoneX";else if(!t&&/iPhone/.test(e)&&screen){var o=screen.height,a=screen.width;812===o||812===a?n="iPhoneX":896!==o&&896!==a||(n="iPhoneXR",devicePixelRatio&&3===devicePixelRatio&&(n="iPhoneXSMax"))}return n}var o=[];e.exports=function(e,t,a){function r(t){if(t&&e.match(t)&&e.match(t).length)return e.match(t)[1]}function i(t){if(t)return e.match(t)&&e.match(t).length>=2?e.match(t):["","0.0.0"]}for(var c=0;c<o.length;c++){var u=o[c];if(u&&u.ua===e&&u.host===t&&u.result instanceof Object)return u.result.isCache=!0,u.result}var s,d,f,l,p,m={isCache:!1};try{if(!e)return;if(m.isMobile=function(){var t=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}(),e.match(/android/i)?(m.os="android",m.osVersion=r(/Android\/([\d\.]+)/i)||r(/Android ([\d\.]+)/),m.kernal=r(/AppleWebKit\/([\d\.]+)/i),m.browserVersion=r(/Chrome\/([\d\.]+)/i)):e.match(/(ipad|iphone|ipod).*os\s([\d_]+)/i)&&(m.os="ios",m.osVersion=r(/iOS\/([\d\.]+)/)||r(/OS ([\d\_]+)/).split("_").join("."),m.kernal=r(/AppleWebKit\/([\d\.]+)/i),m.browserVersion=r(/Safari\/([\d\.]+)/i)),/dp\/com\.dianping/.test(e)){var h=i(/dp\/com\.dianping\.([\w\.]+)\/([\d\.]+)/),g=h[1];d=h[2],-1!==g.indexOf("dpscope")?s="dpapp":-1!==g.indexOf("v1")?(s="dpapp",/adapter\/([\d\.]+)/.test(e)&&(d=r(/adapter\/([\d\.]+)/))):s=-1!==g.indexOf("wedmerchant")?"dpwedmerchant":-1!==g.indexOf("merchant")||"mp.mobile"===g?"dpmerchant":-1!==g.indexOf("wed")?"dpwed":"dp"}else if(/MeituanGroup/i.test(e)){s="mtgroup";var h=i(/(MeituanGroup)\/([\d\.]+)/i);d=h[2]}else/MicroMessenger/.test(e)?(s="weixin",d=r(/MicroMessenger\/([\d\.]+)/i)):/QZONE/.test(e)?(s="qqzone",d=r(/QZONEJSSDK\/([\d\.]+)/)):/QQ\/([\d\.]+)/.test(e)?(s="qq",d=r(/QQ\/([\d\.]+)/i)):/UCWEB/i.test(e)?(s="ucweb",d=r(/UCWEB([\d\.]+)/i)):s="browser";/\.(dianping|dpfile)\.com/i.test(t)?(f="dianping",l="product"):/\.51ping\.com/i.test(t)?(f="dianping",l="beta"):/test(.*)\.(meituan|sankuai)\.(com|net)/i.test(t)?(f="meituan",l="beta"):/\.(meituan|sankuai)\.(com|net)/i.test(t)&&(f="meituan",l="product"),p=n(e,a),m.type=s,m.version=d,m.source=f,m.env=l,m.model=p}catch(e){console.log(e),m.type=s,m.version=d}var _={ua:e,host:t,result:m};return o.length<10?o.push(_):(o.shift(),o.push(_)),m}},112:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){return{code:e,msg:t,data:{},setData:function(n){return{code:e,msg:t,data:n}}}},a={DB_NOT_SUPPORT:o(100,"该浏览器不支持IndexedDB"),PARAM_INVALID:o(101,"无效的参数"),PROPERTY_NOT_SUPPORT:o(102,"DB方法、属性不受支持"),SUCC:o(200,"成功"),DB_NOT_FOUND:o(201,"找不到数据库"),TABLE_NOT_FOUND:o(202,"找不到数据表"),DB_OPEN_FAIL:o(203,"数据库打开失败"),DB_ADD_ITEMS_FAIL:o(204,"数据库添加数据失败"),DB_GET_ITEM_FAIL:o(205,"数据库获取数据失败"),DB_GET_ITEMS_WITH_CURSOR_FAIL:o(206,"数据库使用游标获取数据失败"),DB_DELETE_ITEMS_FAIL:o(207,"删除数据失败"),DB_DELETE_FAIL:o(208,"删除数据库失败"),ITEM_EXPIRED:o(301,"数据过期了"),ITEM_NOT_FOUND:o(302,"找不到数据")};t.default=a},117:function(e,t,n){n(118),e.exports=n(2).Date.now},118:function(e,t,n){var o=n(3);o(o.S,"Date",{now:function(){return(new Date).getTime()}})},119:function(e,t,n){e.exports=n(120)},120:function(e,t,n){n(121),e.exports=n(2).Object.keys},121:function(e,t,n){var o=n(25),a=n(26);n(122)("keys",function(){return function(e){return a(o(e))}})},122:function(e,t,n){var o=n(3),a=n(2),r=n(10);e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],i={};i[e]=t(n),o(o.S+o.F*r(function(){n(1)}),"Object",i)}},123:function(e,t,n){!function(t,n){e.exports=n()}(0,function(){"use strict";function e(){return h?navigator.userAgent.toLowerCase():""}function t(e){for(var t={},n=e.replace(/\([^)]+\)/g,"").split(/\s+/),o="",a=0;a<n.length;a+=1){var r=n[a],i=r.lastIndexOf("/");if(i<0)o=r;else{var c=r.slice(0,i);o&&(c=o+" "+c,o=""),t[c]=r.slice(i-r.length+1)}}return t}function n(e){var t=e||"0",n=t.match(/^(\d*)/);return n?Number(n[1]):0}function o(e,t){for(var o="string"==typeof e?e.split("."):["0"],a="string"==typeof t?t.split("."):["0"],r=Math.max(o.length,a.length),i=0;i<r;i+=1){var c=n(o[i]),u=n(a[i]);if(c>u)return 1;if(c<u)return-1}return 0}function a(e){function t(){clearTimeout(n);var e=o.parentNode;e&&e.removeChild(o),o.onload=null,o.onerror=null,o=null}var n=-1,o=document.createElement("iframe");o.style.display="none",o.onload=t,o.onerror=t,o.src=e,document.documentElement.appendChild(o),n=setTimeout(t,3e3)}function r(e){window.KNBTitansX&&window.KNBTitansX.sendMessage?window.KNBTitansX.sendMessage(e):window.prompt(e)}function i(e){window.prompt(e)}function c(){var n=Function.prototype,c=e();if(/ios|iphone|ipod|ipad/.test(c))n=a;else if(/android/.test(c)){var u=t(c);n=o(u.android,"4.2.0")>0?r:i}return function(e,t,o){var a="js://_?method="+e+"&callbackId="+o+"&args="+encodeURIComponent(t);n(a)}}function u(e,t){if(e&&"object"===(void 0===e?"undefined":y(e))){var n=e;return Object.keys(t).forEach(function(e){n[e]=t[e]}),n}return t}function s(e){if(!/^[a-zA-Z0-9]*$/.test(e))throw new Error("illegal slot name");var t=Math.floor(1e3*Math.random());return+(Date.now().toString().slice(-5)+""+t)+(e?"_"+e:"")}function d(e){return"DPApp_callback_"+e}function f(e,t){var n=d(e),o=window[n];o&&(o(t),o.isSafeDelete&&(window[n]=void 0))}function l(e){var t=e||"DPApp";if(!window[t]||!window[t].KNBCore){var n={dequeue:window[t]&&window[t].dequeue||Function.prototype,KNBCore:!0,callback:f};window[t]=u(window[t],n)}}function p(e,t,n,o){var a=v&&o?"KNBSlot"+o:void 0;l(a);var r=s(a),i=d(r),c=n||{};window[i]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status,n="action"===t?"handle":t;"0"===String(n)&&(n="success"),"handle"!==n&&"success"!==n&&(n="fail");var o=c[n]||Function.prototype;if("function"==typeof o)return o(e)},c.handle||(window[i].isSafeDelete=!0),b.sender&&b.sender(e||"",JSON.stringify(t||{}),r)}function m(e){"function"==typeof e&&(b.sender=e)}var h=!("undefined"==typeof window||!window.navigator||!window.navigator.userAgent),g={getDefaultSender:c,compareVersion:o,parseUserAgent:t,canUseSlot:function(){var n=e(),a=t(n);return o(a.titansx||a.titansnox,"11.13")>=0}()},_=g.getDefaultSender,w=g.compareVersion,D=g.parseUserAgent,v=g.canUseSlot,y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b={sender:null},I={bindSender:m,sendMessage:p,fireCallback:f,compareVersion:w,parseUserAgent:D};return function(e){"undefined"!=typeof window&&(b.sender=_(),window.KNBCore||(window.KNBCore=e))}(I),I})},124:function(e,t,n){"use strict";n.d(t,"a",function(){return I});var o=n(23),a=n.n(o),r=n(107),i=n.n(r),c=n(125),u=n.n(c),s=n(126),d=n.n(s),f=n(45),l=n(108),p=n(24),m=n(130),h=n.n(m),g="logan_web_new_db",_="log_detail_table",w="logReportName",D="log_day_table",v="logDay",y=7*f.a.M_BYTE,b=1*f.a.M_BYTE,I=function(){function e(){u()(this,e),this.DB=new h.a.CustomDB({dbName:g,tableList:[{tableName:_,indexList:[{indexName:w,unique:!1}]},{tableName:D,primaryKey:v}]})}return d()(e,[{key:"logReportNameFormat",value:function(e,t,n){return"".concat(e,"_").concat(t,"_").concat(n)}},{key:"updateLogDaysKeyInfo",value:function(e){var t=this;return new window.Promise(function(n,o){var a=e.map(function(e){var t=l.a.getDawnTime(new Date)-7*l.a.ONE_DAY_TIME_SPAN,n=l.a.getDawnTime(new Date(e.logDay));return{tableName:D,item:e,maxAgeInSeconds:Math.max(0,n-t)/1e3}});t.DB.addItems(a).then(n).catch(o)})}},{key:"getLogDaysInfo",value:function(e){var t=this;return new window.Promise(function(n,o){if(e)t.DB.getItem(D,e).then(n).catch(o);else{var a=l.a.stringify(new Date(l.a.getOffsetDayTime(new Date,-6)));t.DB.getBetweenRange(D,{indexName:v,lowerIndex:a}).then(n).catch(o)}})}},{key:"saveLog",value:function(e,t,n){var o=this;return new window.Promise(function(r,c){var u=f.a.sizeOf(e);if(t.totalSize+u>y)c(p.a.EXCEED_DAY_LIMIT);else{var s=t.logReportPagesInfo.filter(function(e){return e.version===n})[0],d=s.reportPageSizes.length-1,m=s.reportPageSizes[d],h=m>0&&m+u>b,g=o.logReportNameFormat(t.logDay,n,h?d+1:d),v={};v[w]=g,v.logCreateTime=i()(),v.logSize=u,v.logString=e;var I=l.a.countExpireSeconds(new Date,7);o.DB.addItems([{tableName:D,item:a()({},t,{totalSize:t.totalSize+u,logReportPagesInfo:t.logReportPagesInfo.map(function(e){return e.version===n?(h?e.reportPageSizes.push(u):e.reportPageSizes[d]=m+u,e):e})}),maxAgeInSeconds:I},{tableName:_,item:v,maxAgeInSeconds:I}]).then(r).catch(c)}})}},{key:"getLogsOfDay",value:function(e,t,n){var o=this;return new window.Promise(function(a,r){o.DB.getBetweenRange(_,{indexName:w,onlyIndex:o.logReportNameFormat(e,t,n)}).then(a).catch(r)})}}]),e}();I.checkDBNotSupportReason=h.a.checkDBNotSupportReason,I.deleteDB=h.a.deleteDB},125:function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e.exports=n},126:function(e,t,n){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),r(e,o.key,o)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var r=n(127);e.exports=a},127:function(e,t,n){e.exports=n(128)},128:function(e,t,n){n(129);var o=n(2).Object;e.exports=function(e,t,n){return o.defineProperty(e,t,n)}},129:function(e,t,n){var o=n(3);o(o.S+o.F*!n(6),"Object",{defineProperty:n(9).f})},130:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedDB=t.CustomDB=t.getBetweenRangeFromDB=t.getItemFromDB=t.deleteDB=t.getKV=t.setKV=t.checkDBNotSupportReason=t.setDebugger=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(131),c=o(i),u=n(112),s=o(u),d=t.setDebugger=function(){c.default.setDebugger()},f=t.checkDBNotSupportReason=function(){return c.default.checkDBNotSupportReason()},l=t.setKV=function(e,t,n){return new Promise(function(o,a){e?c.default.createDB("SINGLE_DATA_DB",[{tableName:"SINGLE_DATA_STORE",primaryKey:"keyName",indexList:[]}]).then(function(r){var i=r.data.db,u={};u.keyName=e,u.value=t,c.default.deleteExpiredItems(i,["SINGLE_DATA_STORE"]).then(function(){c.default.addItems(i,[{tableName:"SINGLE_DATA_STORE",item:u,maxAgeInSeconds:n}]).then(function(){o(),i.close()}).catch(a)}).catch(a)}).catch(a):a(s.default.PARAM_INVALID.setData({detailErrMsg:"keyName is invalid"}))})},p=t.getKV=function(e){return new Promise(function(t,n){c.default.openDB("SINGLE_DATA_DB").then(function(o){var a=o.data.db;c.default.getItem(a,"SINGLE_DATA_STORE",e).then(function(e){t(e.data.value),a.close()}).catch(n)}).catch(n)})},m=t.deleteDB=function(e){return new Promise(function(t,n){c.default.deleteDB(e).then(function(){t()}).catch(n)})},h=t.getItemFromDB=function(e,t,n){return new Promise(function(o,a){c.default.openDB(e).then(function(e){var r=e.data.db;c.default.getItem(e.data.db,t,n).then(function(e){o(e.data.value),r.close()}).catch(a)}).catch(a)})},g=t.getBetweenRangeFromDB=function(e,t,n){return new Promise(function(o,a){c.default.openDB(e).then(function(e){var r=e.data.db;c.default.getBetweenRange(e.data.db,t,n).then(function(e){o(e.data.values),r.close()}).catch(a)}).catch(a)})},_=t.CustomDB=function(){function e(t){if(a(this,e),!t)throw new Error("CustomDB need dbConfig!");if(!t.dbName)throw new Error("CustomDB dbName invalid!");if(!(t.tableList instanceof Array))throw new Error("CustomDB tableList must be an Array");this.dbName=t.dbName,this.tableList=t.tableList}return r(e,[{key:"addItems",value:function(e){var t=this;return new Promise(function(n,o){e instanceof Array?c.default.createDB(t.dbName,t.tableList).then(function(t){var a=t.data.db;c.default.deleteExpiredItems(a,e.map(function(e){return e.tableName})).then(function(){c.default.addItems(a,e).then(function(){n(),a.close()}).catch(o)}).catch(o)}).catch(o):o(s.default.PARAM_INVALID.setData({detailErrMsg:"addItems input must be an array"}))})}},{key:"getItem",value:function(e,t){var n=this;return new Promise(function(o,a){h(n.dbName,e,t).then(o).catch(a)})}},{key:"getBetweenRange",value:function(e,t){var n=this;return new Promise(function(o,a){g(n.dbName,e,t).then(o).catch(a)})}}]),e}(),w=t.IndexedDB={setDebugger:d,checkDBNotSupportReason:f,getKV:p,setKV:l,deleteDB:m,getItemFromDB:h,getBetweenRangeFromDB:g,CustomDB:_};t.default=w},131:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=n(132),i=o(r),c=n(133),u=o(c),s=n(112),d=o(s),f="expireTime",l=!1,p=function(e,t){return new Promise(function(n,o){i.default.open("IDB_MANAGER_DB",1,function(e){try{e.createObjectStore("IDB_MANAGER_STORE",{keyPath:"dbName"})}catch(e){o(e)}}).then(function(a){A(a,"IDB_MANAGER_STORE",e).then(n).catch(function(r){if(r.code===d.default.ITEM_NOT_FOUND.code){var i={};i.updateTime=Date.now(),i.dbName=e,i.tableList=t,i.version=1;var c=a.transaction("IDB_MANAGER_STORE","readwrite");c.objectStore("IDB_MANAGER_STORE").put(i).catch(o),c.complete.then(n).catch(o)}else o(r)})}).catch(o)})},m=function(e){return new Promise(function(t,n){i.default.open("IDB_MANAGER_DB",1,function(e){try{e.createObjectStore("IDB_MANAGER_STORE",{keyPath:"dbName"})}catch(e){n(e)}}).then(function(o){var a=o.transaction("IDB_MANAGER_STORE","readwrite");a.objectStore("IDB_MANAGER_STORE").delete(e).catch(n),a.complete.then(t).catch(n)}).catch(n)})},h=function(e){return new Promise(function(t,n){i.default.open("IDB_MANAGER_DB",1,function(e){try{e.createObjectStore("IDB_MANAGER_STORE",{keyPath:"dbName"})}catch(e){n(e)}}).then(function(o){A(o,"IDB_MANAGER_STORE",e).then(function(e){t(e.data.value)}).catch(function(t){t.code===d.default.ITEM_NOT_FOUND.code?n(d.default.DB_NOT_FOUND,e+" is not found"):n(t)})}).catch(n)})},g=function(e,t){var n={},o=Date.now();return n.updateTime=o,t>=0&&!isNaN(new Date(o+1e3*parseInt(t)).getTime())?n[f]=o+1e3*parseInt(t):n[f]=-1,a({},e,n)},_=function(e,t,n){if(n){var o="";try{o=JSON.stringify(n)}catch(n){}t=t.setData({detailErrMsg:n.msg||n.message||n.stack||o||n.toString()}),t.code!==d.default.DB_NOT_FOUND.code&&t.code!==d.default.TABLE_NOT_FOUND.code&&t.code!==d.default.ITEM_EXPIRED.code&&t.code!==d.default.ITEM_NOT_FOUND.code&&(0,u.default)(t.code,t.msg,t.data)}l&&console&&console.log(t),e(t)},w=function(e){return e.reduce(function(e,t){return e.indexOf(t)<0?e.concat(t):e},[])},D=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(!o)return"Has invalid tableName";if(t&&!t.objectStoreNames.contains(o))return o+" not found in db "+t.name}return""},v=function(){try{return["indexedDB","IDBDatabase","IDBObjectStore","IDBTransaction","IDBIndex","IDBCursor","IDBKeyRange"].forEach(function(e){if(window&&!window[e])throw new Error(e);if(!window&&self&&!self[e])throw new Error(e)}),""}catch(e){return e.message}},y=function(){console&&console.log("------start db debug------"),l=!0},b=function(e){var t=e.onlyIndex,n=e.lowerIndex,o=e.upperIndex,a=e.lowerExclusive,r=e.upperExclusive;return t||0==t?IDBKeyRange.only(t):!n&&0!=n||!o&&0!=o?n||0==n?IDBKeyRange.lowerBound(n,Boolean(a)):IDBKeyRange.upperBound(o||"",Boolean(r)):IDBKeyRange.bound(n,o,Boolean(a),Boolean(r))},I=function(e,t,n){return new Promise(function(o,a){if(!e)return void _(a,d.default.PARAM_INVALID,"dbName:"+e+" invalid");if(!(t instanceof Array))return void _(a,d.default.PARAM_INVALID,"tableList must be an array");var r=D(t.map(function(e){return e.tableName}));if(r)_(a,d.default.PARAM_INVALID,r);else if(t.length!==w(t.map(function(e){return e.tableName})).length)_(a,d.default.PARAM_INVALID,"tableList has duplicated tableName");else if(v())_(a,d.default.DB_NOT_SUPPORT,new Error(v()));else{var c=function(){i.default.open(e,1,function(n){try{t.forEach(function(e){var t=void 0;"string"==typeof e.primaryKey&&e.primaryKey.trim()?(t=n.createObjectStore(e.tableName,{keyPath:e.primaryKey}),t.createIndex(e.primaryKey,e.primaryKey,{unique:!0})):(t=n.createObjectStore(e.tableName,{keyPath:"id",autoIncrement:!0}),t.createIndex("id","id",{unique:!0})),e.indexList&&e.indexList.forEach(function(e){e.indexName&&t.createIndex(e.indexName,e.indexName,{unique:Boolean(e.unique)})}),t.createIndex(f,f,{unique:!1})})}catch(t){_(a,d.default.DB_OPEN_FAIL,t),n.close(),T(e)}}).then(function(e){_(o,d.default.SUCC.setData({db:e}))}).catch(function(e){_(a,d.default.DB_OPEN_FAIL,e)})};n?c():p(e,t).then(c).catch(function(e){_(a,d.default.DB_OPEN_FAIL,e)})}})},E=function(e){return new Promise(function(t,n){e?v()?_(n,d.default.DB_NOT_SUPPORT,new Error(v())):h(e).then(function(e){I(e.dbName,e.tableList,!0).then(t).catch(function(e){_(n,d.default.DB_OPEN_FAIL,e)})}).catch(function(e){e.code===d.default.DB_NOT_FOUND.code?_(n,d.default.DB_NOT_FOUND,e):_(n,d.default.DB_OPEN_FAIL,e)}):_(n,d.default.PARAM_INVALID,"dbName:"+e+" invalid")})},N=function(e,t){return new Promise(function(n,o){try{if(!(t instanceof Array))return void _(o,d.default.PARAM_INVALID,"itemList must be an array");var a=w(t.map(function(e){return e.tableName})),r=D(a,e);if(r)return void _(o,d.default.PARAM_INVALID,r);var i=e.transaction(a,"readwrite");t.forEach(function(e){var t=i.objectStore(e.tableName),n=g(e.item,isNaN(e.maxAgeInSeconds)?604800:e.maxAgeInSeconds);t.put(n).catch(function(e){_(o,d.default.DB_ADD_ITEMS_FAIL,e);try{i.abort()}catch(e){}})}),i.complete.then(function(){(0,u.default)(d.default.SUCC.code,d.default.SUCC.msg),_(n,d.default.SUCC.setData({detail:"addItems succ"}))}).catch(function(e){_(o,d.default.DB_ADD_ITEMS_FAIL,e)})}catch(e){_(o,d.default.DB_ADD_ITEMS_FAIL,e)}})},A=function(e,t,n){return new Promise(function(o,a){try{if(e.objectStoreNames.contains(t)){e.transaction(t,"readonly").objectStore(t).get(n).then(function(e){e?e[f]>0&&e[f]<Date.now()?_(a,d.default.ITEM_EXPIRED):_(o,d.default.SUCC.setData({value:e})):_(a,d.default.ITEM_NOT_FOUND)}).catch(function(e){_(a,d.default.DB_GET_ITEM_FAIL,e)})}else _(a,d.default.TABLE_NOT_FOUND)}catch(e){_(a,d.default.DB_GET_ITEM_FAIL,e)}})},B=function(e,t,n){return new Promise(function(o,a){try{if(!e.objectStoreNames.contains(t))return void _(a,d.default.TABLE_NOT_FOUND);var r=e.transaction(t,"readonly"),i=r.objectStore(t);if(n){var c=[],u=function e(t){t?(c.push(t.value),t.continue().then(e).catch(function(e){_(a,d.default.DB_GET_ITEMS_WITH_CURSOR_FAIL,e)})):_(o,d.default.SUCC.setData({values:c}))},s=i.index(n.indexName);"function"!=typeof s.openCursor?_(a,d.default.PROPERTY_NOT_SUPPORT,"index.openCursor is not supported"):s.openCursor(b(n)).then(u).catch(function(e){_(a,d.default.DB_GET_ITEMS_WITH_CURSOR_FAIL,e)})}else i.getAll().then(function(e){_(o,d.default.SUCC.setData({values:e||[]}))}).catch(function(e){_(a,d.default.DB_GET_ITEM_FAIL,e)})}catch(e){_(a,d.default.DB_GET_ITEMS_WITH_CURSOR_FAIL,e)}})},S=function(e,t){function n(t,o,a){if(t.length>0)try{var r=t[0],i=e.transaction(r,"readwrite"),c=i.objectStore(r),u=c.index(f),s=function e(r){r?(c.delete(r.primaryKey).catch(function(e){_(a,d.default.DB_DELETE_ITEMS_FAIL,e)}),r.continue().then(e).catch(function(e){_(a,d.default.DB_DELETE_ITEMS_FAIL,e)})):n(t.slice(1),o,a)};"function"!=typeof u.openCursor?_(a,d.default.PROPERTY_NOT_SUPPORT,"index.openCursor is not supported"):u.openCursor(b({indexName:f,lowerIndex:0,upperIndex:Date.now(),lowerExclusive:!1,upperExclusive:!1})).then(s).catch(function(e){_(a,d.default.DB_DELETE_ITEMS_FAIL,e)})}catch(e){_(a,d.default.DB_DELETE_ITEMS_FAIL,e)}else o()}return new Promise(function(o,a){if(t instanceof Array){var r=w(t);D(r,e)?o():n(r,o,a)}else o()})},T=function(e){return new Promise(function(t,n){m(e).then(function(){i.default.delete(e).then(function(){_(t,d.default.SUCC.setData({detail:"deleteDB succ"}))}).catch(function(e){_(n,d.default.DB_DELETE_FAIL,e)})}).catch(function(e){_(n,d.default.DB_DELETE_FAIL,e)})})},O={checkDBNotSupportReason:v,setDebugger:y,createDB:I,openDB:E,addItems:N,getItem:A,getBetweenRange:B,deleteExpiredItems:S,deleteDB:T};t.default=O},132:function(e,t,n){"use strict";function o(e){return Array.prototype.slice.call(e)}function a(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function r(e,t,n){var o,r=new Promise(function(r,i){o=e[t].apply(e,n),a(o).then(r,i)});return r.request=o,r}function i(e,t,n){var o=r(e,t,n);return o.then(function(e){if(e)return new l(e,o.request)})}function c(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function u(e,t,n,o){o.forEach(function(o){o in n.prototype&&(e.prototype[o]=function(){return r(this[t],o,arguments)})})}function s(e,t,n,o){o.forEach(function(o){o in n.prototype&&(e.prototype[o]=function(){return this[t][o].apply(this[t],arguments)})})}function d(e,t,n,o){o.forEach(function(o){o in n.prototype&&(e.prototype[o]=function(){return i(this[t],o,arguments)})})}function f(e){this._index=e}function l(e,t){this._cursor=e,this._request=t}function p(e){this._store=e}function m(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function h(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new m(n)}function g(e){this._db=e}Object.defineProperty(t,"__esModule",{value:!0}),p.prototype.createIndex=function(){return new f(this._store.createIndex.apply(this._store,arguments))},p.prototype.index=function(){return new f(this._store.index.apply(this._store,arguments))},m.prototype.objectStore=function(){return new p(this._tx.objectStore.apply(this._tx,arguments))},h.prototype.createObjectStore=function(){return new p(this._db.createObjectStore.apply(this._db,arguments))},g.prototype.transaction=function(){return new m(this._db.transaction.apply(this._db,arguments))};var _;!function(){try{return["IDBIndex","IDBCursor","IDBObjectStore","IDBTransaction","IDBDatabase"].forEach(function(e){if(window&&!window[e])throw new Error(e);if(!window&&self&&!self[e])throw new Error(e)}),""}catch(e){return e.message}}()?(c(f,"_index",["name","keyPath","multiEntry","unique"]),u(f,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),d(f,"_index",IDBIndex,["openCursor","openKeyCursor"]),c(l,"_cursor",["direction","key","primaryKey","value"]),u(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(e){e in IDBCursor.prototype&&(l.prototype[e]=function(){var t=this,n=arguments;return Promise.resolve().then(function(){return t._cursor[e].apply(t._cursor,n),a(t._request).then(function(e){if(e)return new l(e,t._request)})})})}),c(p,"_store",["name","keyPath","indexNames","autoIncrement"]),u(p,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),d(p,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(p,"_store",IDBObjectStore,["deleteIndex"]),c(m,"_tx",["objectStoreNames","mode"]),s(m,"_tx",IDBTransaction,["abort"]),c(h,"_db",["name","version","objectStoreNames"]),s(h,"_db",IDBDatabase,["deleteObjectStore","close"]),c(g,"_db",["name","version","objectStoreNames"]),s(g,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[p,f].forEach(function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t=o(arguments),n=t[t.length-1],a=this._store||this._index,r=a[e].apply(a,t.slice(0,-1));r.onsuccess=function(){n(r.result)}})})}),[f,p].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,o=[];return new Promise(function(a){n.iterateCursor(e,function(e){return e?(o.push(e.value),void 0!==t&&o.length==t?void a(o):void e.continue()):void a(o)})})})}),_={open:function(e,t,n){var o=r(indexedDB,"open",[e,t]),a=o.request;return a&&(a.onupgradeneeded=function(e){n&&n(new h(a.result,e.oldVersion,a.transaction))}),o.then(function(e){return new g(e)})},delete:function(e){return r(indexedDB,"deleteDatabase",[e])}}):_={open:function(e,t,n){return Promise.reject(new Error("PROPERTY_NOT_SUPPORT"))},delete:function(e){return Promise.reject(new Error("PROPERTY_NOT_SUPPORT"))}},t.default=_},133:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a=1,r=void 0,i=function(){return r||(window&&window.Owl?r=new window.Owl.OWL({project:"indexeddb",devMode:window.Owl.cfgManager.get("devMode"),resource:{sampleApi:1,delay:100}}):null)},c=function(e,t,n){var r=i();if(r&&a>0){var c={name:t||"",statusCode:e,content:JSON.stringify(o({link:location.href,userAgent:window&&window.navigator&&window.navigator.userAgent},n))};r.addApi(c),a--}};t.default=c},97:function(e,t,n){"use strict";function o(){var e=(navigator.userAgent+"").toLowerCase(),t="([0-9][0-9.a-zA-Z_]*)",n=function(e){return new RegExp(e,"i")},o=function(e){return"string"==typeof e},a=location.href,i={dianping:[/com\.dianping\.ba.\w+/,/com\.dianping\.\w+/],meituan:["meituangroup",/com.meituan.imeituan-?\w+/],maoyanpro:["moviepro","moviepro/android"],maoyan:["movie"],moma:["moma"],daxiang:["xm"],wechat:["micromessenger"],qq:["qq"],unknown:["never_match_anything"]},c=function(){for(var t=r()(i),a=0;a<t.length;a++)for(var c=i[t[a]],u=0;u<c.length;u++)if(o(c[u])?n("\\W"+c[u]+"\\W").test(e):c[u].test(e))return t[a];return"unknown"}(),u=function(){for(var a=i[c],r=0;r<a.length;r++){var u=o(a[r])?a[r]:a[r].source,s=e.match(n(u+" "+t))||e.match(n(u+"/"+t));if(s)return s[1]}return"0"}(),s=function(){return/android/.test(e)?"android":/ios|iphone|ipod|ipad/.test(e)?"ios":/macintosh/.test(e)?"mac":/windows/.test(e)?"windows":"unknown"}(),d=function(){var o;return"android"===s&&(o=e.match(n("android "+t))||e.match(n("android/"+t))),"ios"===s&&(o=e.match(n(t+" like Mac OS X"))||e.match(n("iOS/"+t))),(o?o[1]:"0").replace(/_/g,".")}(),f=n("(KNB)/".concat(t," (\\w+)/").concat(t," App/[0-9]+/[0-9][0-9.a-zA-Z_]* (\\w+)/").concat(t)),l=n("(KNB)/".concat(t," (\\w+)/").concat(t," App/[0-9]+/[0-9][0-9.a-zA-Z_]* ([a-z1-9A-Z_.-]+/[a-z1-9A-Z_.-]+)/").concat(t)),p=n("(KNB)/".concat(t," (\\w+)/").concat(t," (\\w+)/").concat(t)),m=n("(KNB)/".concat(t," (\\w+)/").concat(t," ([a-z1-9A-Z_.-]+/[a-z1-9A-Z_.-]+)/").concat(t)),h=e.match(f)||e.match(l)||e.match(p)||e.match(m),g=h&&h[2];"unknown"===c&&h&&(c=h[5],u=h[6]),"unknown"===c&&a.indexOf("wm_ctype=")>-1&&(c="waimai");var _=e.match(n("(TitansX|TitansNoX)/".concat(t))),w=_&&_[2];return{appName:c,appVersion:u,osName:s,osVersion:d,titansxVersion:w,_knbVersion:g}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(119),r=n.n(a),i=n(123),c=n.n(i),u=n(109)();t.default={isValidApp:function(){if("dpapp"===u.type||"mtgroup"===u.type||!0===u.isMobile){var e=o(),t="dianping"===e.appName&&c.a.compareVersion(e.appVersion,"9.10")>=0,n="dianping"!==e.appName&&c.a.compareVersion(e.titansxVersion,"11.11")>=0;return t||n}return!1}(),getUA:function(){return u},getKNB:function(){return c.a}}},99:function(e,t,n){"use strict";function o(e){var t=b.a.checkDBNotSupportReason();t?D.a.cat(v.a.DB_NOT_SUPPORT.code,v.a.DB_NOT_SUPPORT.msg,{notSupportReason:t}):(P.push(e),r())}function a(){R=!1,r()}function r(){if(!R&&P.length>0&&!I.a.canSave())P.shift(),console.log("Can not save because of LogManager error limit"),a();else if(!R&&P.length>0){var e=P.shift();R=!0,i(O).then(function(t){t?Object(A.a)(n.e(5).then(n.bind(null,164))).then(function(n){var o,r=_.a.generateRandomBytes(16),i=t.keys.filter(function(e){return 1===e.version})[0];try{o={log:n.encryptCTR(s(e),i.logKey,r),iv:r}}catch(e){D.a.cat(v.a.ENCRYPT_ERROR.code,"aes加密失败",{error:e.stack||e.toString()})}o?O.saveLog(p()(o),t,T).then(function(){D.a.cat(v.a.SAVE_SUCC.code,v.a.SAVE_SUCC.msg),a()}).catch(function(e){e.msg===v.a.EXCEED_DAY_LIMIT.msg?(console.log("超过当天日志限额"),D.a.cat(v.a.EXCEED_DAY_LIMIT.code,v.a.EXCEED_DAY_LIMIT.msg)):D.a.cat(v.a.SAVE_LOG_FAIL.code,v.a.SAVE_LOG_FAIL.msg,{error:e.message||p()(e)}),a()}):a()}).catch(function(e){D.a.cat(v.a.ASYNC_IMPORT_ERROR.code,"异步加载aes失败",{error:e.stack||e.toString()}),a()}):(D.a.cat(v.a.UNKNOWN_ERROR.code,"没有拿到今天的索引数据",{time:h()()}),a())}).catch(function(e){D.a.cat(v.a.KEY_PROCESS_FAIL.code,v.a.KEY_PROCESS_FAIL.msg,{error:e.message||p()(e)}),a()})}}function i(e){return new window.Promise(function(t,o){var a=function(t){return new window.Promise(function(n,o){var a=c(t);e.updateLogDaysKeyInfo(a).then(function(){n(a.filter(function(e){return x(e)})[0])}).catch(o)})};e.getLogDaysInfo().then(function(e){e.length<=0||1===e.length&&g.a.isToday(new Date(e[0].logDay))?a(e).then(t).catch(o):Object(A.a)(n.e(4).then(n.bind(null,140))).then(function(n){var r=u(e,n);a(r).then(t).catch(o)}).catch(function(n){a(e).then(t).catch(o),D.a.cat(v.a.ASYNC_IMPORT_ERROR.code,"异步加载rsa失败",{error:n.stack||n.toString()})})}).catch(function(e){201===e.code||202===e.code?a([]).then(t).catch(o):o(e)})})}function c(e){return(e||[]).filter(function(e){return x(e)})[0]?e.map(function(e){return x(e)&&e.logReportPagesInfo&&!e.logReportPagesInfo.filter(function(e){return e.version===T})[0]?(e.logReportPagesInfo.push({version:T,reportPageSizes:[0]}),e):e}):(e||[]).concat(function(){return{logDay:g.a.stringify(new Date),keys:[{version:1,logKey:_.a.generateRandomBytes(16),logSecretKey:""}],logReportPagesInfo:[{version:T,reportPageSizes:[0]}],totalSize:0}}())}function u(e,t){return e.map(function(e){var n=f()({},e);return n.logDay&&!g.a.isToday(new Date(n.logDay))&&n.keys&&n.keys.length>0&&(n.keys=n.keys.map(function(e){if(1!==e.version||!e.logKey)return e;try{return{version:1,logKey:"",logSecretKey:t.encrypt(e.logKey,t.PUBLIC_KEY)}}catch(t){return D.a.cat(v.a.ENCRYPT_ERROR.code,"rsa加密失败",{error:t.stack||t.toString()}),{version:1,logKey:e.logKey,logSecretKey:""}}})),n})}function s(e){var t=w.a.get("logan_session_token")||w.a.set("logan_session_token",_.a.generateRandomBytes(20)),n={f:e.logType,c:"".concat(encodeURIComponent(e.logString)),d:"".concat(h()()),l:"".concat(h()()),m:"true",s:"".concat(t),t:e.logLevel};return p()(n)+"\n"}Object.defineProperty(t,"__esModule",{value:!0});var d=n(23),f=n.n(d),l=n(27),p=n.n(l),m=n(107),h=n.n(m),g=n(108),_=n(45),w=n(48),D=n(46),v=n(24),y=n(97),b=n(124),I=n(32),E=n(47),N=n(28),A=n(29),B=1*_.a.M_BYTE,S=E.a.LOG_TYPE_MAP,T=1,O=new b.a,P=[],R=!1,x=function(e){return e.logDay&&g.a.isToday(new Date(e.logDay))};t.default=function(e,t,n){var a=_.a.sizeOf(e||"");if(a<=0)console.log("日志内容为空");else if(a>B)console.log("日志内容大小为".concat(a,"B，超过限额").concat(_.a.readableByte(B))),D.a.cat(v.a.EXCEED_SINGLE_LOG_LIMIT.code,"日志单条内容大小超过限额");else{N.a.get("devMode")&&console.log("[Logan]<日志内容>".concat(e));var r={logString:e,logType:"".concat(S[(t&&"".concat(t)||"default").toLocaleLowerCase()]||S.default),logLevel:n||"log"};y.default.isValidApp?y.default.getKNB().sendMessage("sendLog",{text:r.logString,type:r.logType,time:+new Date,page:location.href},{success:function(){D.a.cat(v.a.KNB_SAVE_SUCC.code,v.a.KNB_SAVE_SUCC.msg)},fail:function(e){D.a.cat(v.a.KNB_SAVE_FAIL.code,v.a.KNB_SAVE_FAIL.msg,{error:p()(e)})}},"logan"):o(r)}}}});